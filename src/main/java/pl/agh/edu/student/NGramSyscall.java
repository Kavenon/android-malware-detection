package pl.agh.edu.student;

import java.util.HashMap;
import java.util.LinkedList;

public class NGramSyscall {
    public NGramSyscall(LogStatus nGramStatus, LinkedList<SyscallLogRegistry> nGramSyscalls) {
        this.nGramStatus = nGramStatus;
        this.nGramSyscalls = nGramSyscalls;
    }

    public NGramSyscall() {
    }

    private LogStatus nGramStatus;
    private LinkedList<SyscallLogRegistry> nGramSyscalls;
    public int numberOfOccurences = 0;
    public double frequency = 0;
    private LogStatus predictedStatus;

    public LogStatus getnGramStatus() {
        return nGramStatus;
    }

    public void setnGramStatus(LogStatus nGramStatus) {
        this.nGramStatus = nGramStatus;
    }

    public LinkedList<SyscallLogRegistry> getnGramSyscalls() {
        return nGramSyscalls;
    }

    public void setnGramSyscalls(LinkedList<SyscallLogRegistry> nGramSyscalls) {
        this.nGramSyscalls = nGramSyscalls;
    }

    public String getVector(){
        String vector = "";

        for(SyscallLogRegistry syscall : nGramSyscalls) {
            vector += syscall.getSyscall() + " ";
        }

        return vector.trim();
    }

    public LogStatus getPredictedStatus() {
        return predictedStatus;
    }

    public void setPredictedStatus(LogStatus predictedStatus) {
        this.predictedStatus = predictedStatus;
    }

    public void setPredictedStatus(String statusName) {
        System.out.println(statusName);
        if(statusName.equals("GOOD"))
            this.predictedStatus = LogStatus.GOOD;
        else
            this.predictedStatus = LogStatus.MALICIOUS;
    }
}
